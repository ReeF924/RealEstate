<main class="main-index">
    <section class="search-bar-container">
        <h1 class="search-bar-h1">Vyberte si svuj novy byt</h1>
        <form class="search-bar-form">
            <input type="text" name="search-bar" class="search-bar-text" placeholder="Vyhledat podle mesta"
                   required>
            <div class="search-bar-button-container">
                <button class="btn-orange search-bar-button" type="submit">HLEDAT</button>
            </div>
        </form>
    </section>
    
    @{
        var offers = (List<Offer>)this.ViewBag.Offers;
        Dictionary<char, int> field = offers.GetCategoryCount();
        if (this.ViewBag.Filter != null)
            offers = offers.Where(offer => offer.Category == this.ViewBag.Filter).ToList();
    }
    <section class="filters">
        <a class="dark-layer-over" asp-action="index" asp-route-filter="f">
            <img src="/images/rest/home-img-03-442-280.jpg">
            <label>Flats</label>
            <div class="subtext">@field['f'] offers</div>
        </a>
        <a class="dark-layer-over" asp-action="index" asp-route-filter="l">
            <img src="/images/Rest/home-img-04-442-280.jpg">
            <label>Luxury</label>
            <div class="subtext">@field['l'] offers</div>
        </a>
        <a class="dark-layer-over" asp-action="index" asp-route-filter="h">
            <img src="/images/Rest/home-img-01-442-280.jpg">
            <label>Houses</label>
            <div class="subtext">@field['h'] offers</div>
        </a>
        <a class="dark-layer-over" asp-action="index" asp-route-filter="c">
            <img src="/images/Rest/home-img-02-442-280.jpg">
            <label>Cottages</label>
            <div class="subtext">@field['c'] offers</div>
        </a>
    </section>
    <section class="items-section">
        <div class="center-content choice-header-container">
            <div class="partial-border">
                <h2>Nase nabidka</h2>
            </div>
        </div>
        <div>
            @{

                if (offers == null) return;
                int repeatCount = Math.Min(offers.Count, 6);
                <div class="offers-list">
                    @for (int i = 0; i < repeatCount; i++)
                    {
                        Offer offer = offers[i];

                        <div class="flex-column">
                            <div class="offer-img-container">
                                <a asp-asp-controller="EstateOffers" asp-action="Detail" asp-route-id="@offer.Id">
                                    @{
                                        var image = offer.Images?.FirstOrDefault();
                                        string relPath = image != null ? PathHelper.GetPathToImage("Offers", image.IdOffer.ToString(), image.Id.ToString()) : PathHelper.NotFoundImg;
                                    }
                                    <img src="@relPath" alt="offered-house">
                                </a>
                            </div>
                            <div class="offer-information">
                                <h3 class="item-name">@offer.Name</h3>
                                <span class="item-price-tag">@offer.Price Kč</span>
                                <p class="item-description">
                                    @{
                                        string addition = offer.Description.Length > 100 ? "..." : "";
                                    }
                                    @(offer.ShortDescription == null ? offer.Description.Substring(0, Math.Min(97, offer.Description.Length)) + addition : offer.ShortDescription)
                                </p>
                            </div>
                        </div>
                    }`
                </div>
            }
        </div>
        <div class="items-view-all-container">
            <a class="btn-orange items-view-all">
                Zobrazit vše
            </a>
        </div>
    </section>
</main>
<section class="experiences">
    <div class="center-content">
        <h2 class="experiences-title partial-border">Zkušenosti zákazníků</h2>
    </div>
    <div class="customer-ratings">
        <div class="rating-container">
            <img class="mr-10" src="./images/Rest/josh_hutcherson_whistle.jpg" alt="lisa">
            <div class="flex-column jf-space-between">
                <p>Thank you for your prompt response and the help that you gave me. You always have a quick solution to any problem. What an excellent level of customer service!</p>
                <p class="customer-name">Josh Hutcherson</p>
            </div>
        </div>
        <div class="rating-container">
            <img class="mr-10" src="./images/Rest/nickyCageMeme.png" alt="lisa">
            <div class="flex-column jf-space-between">
                <p">
                    I just want to thank you for your help. I was so pleased and grateful. Keep up the excellent work. Your site provides the best support I have ever encountered.</p>
                    <p class="customer-name">Nicholas Cage</p>
            </div>
        </div>
    </div>
</section>
